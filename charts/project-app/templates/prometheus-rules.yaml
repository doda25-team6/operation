apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "project-app.fullname" . }}-prometheus-rules
  labels:
    {{- include "project-app.labels" . | nindent 4 }}
data:
  alert.rules: |
    groups:
    - name: application
      interval: 30s
      rules:
      - alert: HighRequestRate
        expr: rate(navigation_requests_total[1m]) * 60 > 15
        for: 2m
        labels:
          severity: warning
          component: frontend
        annotations:
          summary: "High request rate detected"
          description: "Service is receiving {{ `{{ $value | humanize }}` }} requests per minute, which exceeds the threshold of 15 requests/minute for 2 minutes."
          dashboard: "http://project.local/sms/"
